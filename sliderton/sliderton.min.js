/**
 * Create a slideshow style similar to itunes
 * @developer Eric Casequin
 * @date June 14 2011
 * @version 1.0.0a
 *
 * This is a slideshow similar to itunes original store slideshow
 * The current slide will be in the large view while the optional
 * slides will be in the sidebar. It uses an infinite carousel
 * type navigation.
 * 
 * Expected usage:
 * - Slide show is auto animated on a timer
 * - If user mouses over slideshow in any area, slide show stops
 *   when users mouse exits, timer begins again
 * 
 */
jQuery.fn.extend({sliderton:function(g){var g=$.extend({debug:false,sliderton_id:"sliderton",slides_container_id:"slide-container",slides_class:"slide",slides_nav_id:"slide-navigation",slides_nav_class:"slide-nav",slide_next_button:"next-slide",wrapper:'wrapper',nav_items_visible:3,slide_container_width:600,slide_container_height:300,slide_width:600,slide_height:300,nav_container_width:100,nav_container_height:300,nav_item_width:100,nav_item_height:100,next_button:true},g);var h=$("#"+g.sliderton_id);var j=$("#"+g.slides_container_id+" ."+g.wrapper);var k=j.find('.'+g.slides_class);var l=$("#"+g.slides_nav_id+" ."+g.wrapper);var m=$("."+g.slides_nav_class);var n=new Array();var p;var q;var r;var s=0;var t=0;var u='getContext'in document.createElement('canvas');var v=function(){navigationSlides=$(".slide-nav");array=$.makeArray(navigationSlides);array.reverse();$(array).appendTo(l);if(m.length!=k.length){console.log("ALERT: Slides and NavSlides are not matched up, make sure both are even in count. ")};k.each(function(i,a){n[i]={slide:k[i],navSlide:m[i]}});for(var i=0;i<n.length;i++){$(n[i].navSlide).css({opacity:.5}).hover(function(){$(this).stop().animate({opacity:1},'fast')},function(){$(this).stop().animate({opacity:.5},'fast')})};I(true);q=0;$(n[q].slide).fadeIn();w();if(g.next_button==true){x()}};var w=function(){position=0;offset=g.nav_item_height;l.css('top',position-offset)};var x=function(){if(u){z()}else{y()}A(p)};var y=function(){p=$('<div></div>').hide().addClass('next-button').html("V");h.append(p.show())};var z=function(a){var b={radius:16,shadowBlur:5,stroke:1};var o={w:(b.radius+b.stroke+b.shadowBlur)*2,h:(b.radius+b.stroke+b.shadowBlur)*2,c:(b.radius+b.stroke+b.shadowBlur)};var c=$('<canvas></canvas>').hide().attr({id:"next-button",width:o.w,height:o.h}).addClass('next-button-c');h.append(c.show());var d=document.getElementById("next-button");var e=d.getContext("2d");var f=e.createLinearGradient(0,0,0,b.radius*2);f.addColorStop(0,'#666');f.addColorStop(1,'#222');e.strokeStyle="#666";e.fillStyle=f;e.beginPath();e.arc(o.c,o.c,b.radius,0,Math.PI*2,true);e.shadowOffsetX=0;e.shadowOffsetY=0;e.shadowBlur=5;e.shadowColor='rgba(0, 0, 0, 0.5)';e.closePath();e.stroke();e.fill();e.beginPath();e.moveTo(o.c,o.c+b.radius/2);e.lineTo(o.c-(b.radius/2),o.c-(b.radius/3));e.moveTo(o.c,o.c+b.radius/2);e.lineTo(o.c+(b.radius/2),o.c-(b.radius/3));e.strokeStyle="#DDD";e.shadowOffsetX=0;e.shadowOffsetY=1;e.shadowBlur=0;e.shadowColor='rgba(0, 0, 0, 0.5)';e.stroke();p=$('#next-button');p.css('opacity',.5)};var A=function(a){a.hover(function(){a.css('cursor','pointer');$(a).stop().animate({opacity:1})},function(){$(a).stop().animate({opacity:.4})});a.click(function(){if(B()==false){H()}})};var B=function(){a=($('.slide').filter(':animated')).length;return a?true:false};var C=function(){if(g.debug){console.log(m.length)};m.each(function(i,a){$(this).clone(true).addClass('slide-clone').prependTo(l)});m=$("."+g.slides_nav_class);m.each(function(i,a){n[i]=$(this);$(this).css({opacity:.5}).hover(function(){$(this).stop().animate({opacity:1})},function(){$(this).stop().animate({opacity:.5})})})};var D=function(){m.each(function(){t+=$(this).height()});k.each(function(){s+=$(this).height()});l.css('height',t+"px");j.css('height',s+"px")};var E=function(a){if(a.css('top')=="auto"){return+g.nav_item_height}else{return parseInt(a.css('top'))+g.nav_item_height}};var F=function(a){if(a.css('top')=="auto"){return-g.slide_height}else{return parseInt(a.css('top'))-g.slide_height}};var G=function(){r=q;if(q==n.length-1){q=0}else{q++}};var H=function(){G();if(g.debug){console.log("CURRENT: "+q+" PREVIOUS: "+r)};$(n[r].slide).fadeOut();$(n[q].slide).fadeIn();I()};var I=function(a){var b=$('.slide-nav');newest=b.last().clone(true).addClass('slide-clone').prependTo(l).css({height:0}).stop().animate({height:100},function(){b.last().remove()})};this.each(function(){v()})}});